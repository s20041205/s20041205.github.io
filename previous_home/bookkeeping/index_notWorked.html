<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	
	<title>2022記帳</title>
	<!--<script
		src="https://code.jquery.com/jquery-3.4.1.js"
		integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
		crossorigin="anonymous"></script>
	<script>
		function SubForm (){
			$.ajax({
				url:"https://api.apispreadsheets.com/data/srt2P9qba12Uo4hA/",
				type:"post",
				data:$("#myForm").serializeArray(),
				success: function(){
					alert("Submitted :)")
				},
				error: function(){
					alert("There was an error :(")
				}
			});
		}
	</script>-->
</head>
<body>
	<header></header>
	<section id="form">
		<div class="container">
			<div class="row">
				<div class="col-md-8">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="#">記帳</a></li>
						<li class="breadcrumb-item active" aria-current="page">v2.0.0</li>
						</ol>
					</nav>
				</div>
			</div>
			<!--<div class="row">
				<div class="col-md-6 offset-md-1 text-left">
					<div class="row">
						<form id="myForm" >
							<p for="dateinput">日期</p>
							<input name="Date" type="date" id="fdate">
							
							<p>收支</p>
							<select name="Balance" id="balance-list" onchange="changeBalance(this.selectedIndex)"></select>

							<p>類別</p>
							<select name="Topclass" id="topclass-list" onchange="changetopclass()"></select>
							
							<p>細項</p>
							<select name="Subclass" id="subclass-list"></select>
							
							<p>金額</p>
							<input name="Price" type="number" id="price" placeholder="金額"></input>
							
							<p>內容</p>
							<input name="Detail" type="text" id="detail" placeholder="內容"></input>
							
							<p>人員</p>
							<select name="Name" id="who-list"></select>
							
							<p></p>
							<input name="Update" type="tel" id="dtCur" readonly="readonly">
							<input type="button" onclick="SubForm()" value="Submit">
							
						</form>
					</div>
				</div>
			</div>-->
		<form name="submit-to-google-sheet">
			<input name="Date" type="date" placeholder="Date" required>
			<input name="Balance" type="text" id="balance-list" placeholder="Income/Outcome"></input>
			<input name="Topclass" type="text" id="topclass-list" placeholder="Topclass"></input>
			<input name="Subclass" type="text" id="subclass-list" placeholder="Subclass"></input>
			<!--<select name="Balance" type="text" id="balance-list" onchange="changeBalance(this.selectedIndex)"></select>
			<select name="Topclass" type="text" id="topclass-list" onchange="changetopclass()"></select>
			<select name="Subclass" type="text" id="subclass-list"></select>-->
			<input name="Price" type="number" placeholder="Price" required>
			<input name="Detail" type="text" placeholder="Detail">
			<select name="Name" type="text" id="who-list"></select>
			<!--<input name="Update" type="text" placeholder="Time" readonly="readonly">-->
			<button type="submit">Send</button>
		</form>
		</div>
	<script>
		//[post form data to google sheet]
		const scriptURL = 'https://script.google.com/macros/s/AKfycbwTnRmFw98Y-IxM8ysZkmJzd10VYhAjVi8YnEcdDsN5lqFbri3ORy66ZObZzN1x1wk/exec'
		const form = document.forms['submit-to-google-sheet']

		form.addEventListener('submit', e => {
			e.preventDefault()
			fetch(scriptURL, { method: 'POST', body: new FormData(form)})
			.then(response => console.log('Success!', response))
			.catch(error => console.error('Error!', error.message))
		})
	</script>
	<script>
		//[form combobox items]
		var today = new Date();
		var date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
		var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
		var dateTime = date+' '+time;
		document.getElementById("fdate").valueAsDate = today;
		document.getElementById("dtCur").value = dateTime;
		</script>
	<script type="text/javascript">
		var balance=['請選擇', '收入', '支出'];
		var balanceSelect=document.getElementById("balance-list");
		var balanceInner="";
		for(var i=0;i<balance.length;i++){
			balanceInner=balanceInner+'<option>'+balance[i]+'</option>';
		}
		balanceSelect.innerHTML=balanceInner;
		
		
		var topclass=new Array();
		topclass[0]=[];
		topclass[1]=['薪資', '利息', '獎金', '投資', '販賣'];
		topclass[2]=['飲食', '衣裝', '居住', '交通', '教育', '娛樂', '健康', '社交', '其他'];	
		function changeBalance(index){
			var topclassInner="";
			for(var i=0;i<topclass[index].length;i++){
				topclassInner=topclassInner+'<option>'+topclass[index][i]+'</option>';
			}
			var topclassSelect=document.getElementById("topclass-list");
			topclassSelect.innerHTML=topclassInner;
			var subclassSelect=document.getElementById("subclass-list");
			subclassSelect.innerHTML="";
		}
		
		
		var subclass=new Array();
		subclass[0]=['早餐', '午餐', '晚餐', '食材', '水果', '零食', '飲料'];	
		subclass[1]=['衣服', '鞋子', '包包', '理髮', '美容'];	
		subclass[2]=['房租', '水費', '電費', '瓦斯費', '網路費', '生活消耗品', '家電', '家具', '生活物品', '維修費'];	
		subclass[3]=['汽油燃料', '維修保養', '火車高鐵', '捷運', '公車', '計程車', '公共租借', '停車費', '過路費'];	
		subclass[4]=['文具', '書籍', '材料', '課程學費'];	
		subclass[5]=['手機費', '3C產品', '旅宿', '門票', '遊戲', '電影', '數位服務'];	
		subclass[6]=['門診', '手術', '藥品', '運動'];	
		subclass[7]=['捐款', '孝親費', '交際'];	
		subclass[8]=['貸款', '稅務', '罰單', '保險', '手續費', '其他'];	
		function changetopclass(){
			var index = document.getElementById("topclass-list").selectedIndex;
			var bindex = document.getElementById("balance-list").selectedIndex;
			var subclassInner="";
			if(bindex < 2)
			{
				subclassInner="";
			}
			else
			{
				for(var i=0;i<subclass[index].length;i++){
					subclassInner=subclassInner+'<option>'+subclass[index][i]+'</option>';
				}
			}
			var subclassSelect=document.getElementById("subclass-list");
			subclassSelect.innerHTML=subclassInner;
		}
		/*function changetopclass(){
			var index = document.getElementById("topclass-list").selectedIndex;
			var bindex = document.getElementById("balance-list").selectedIndex;
			var subclassInner="";
			if(bindex < 2)
			{
				subclassInner="";
			}
			else
			{
				for(var i=0;i<subclass[index].length;i++){
					subclassInner=subclassInner+'<option>'+subclass[index][i]+'</option>';
				}
			}
			var subclassSelect=document.getElementById("subclass-list");
			subclassSelect.innerHTML=subclassInner;
		}*/
		
		var who=['Jerry_Hu', 'Alice_Lin'];
		var whoSelect=document.getElementById("who-list");
		var whoInner="";
		for(var i=0;i<who.length;i++){
			whoInner=whoInner+'<option>'+who[i]+'</option>';
		}
		whoSelect.innerHTML=whoInner;
	</script>
	</section>
</body>
</html>
